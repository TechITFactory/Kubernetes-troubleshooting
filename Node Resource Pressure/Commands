Recreate: Pod exceeds its ephemeral-storage limit → Evicted:
evict-ephemeral.yaml

apiVersion: v1
kind: Pod
metadata:
  name: eph-evict-demo
spec:
  containers:
  - name: writer
    image: busybox:1.36
    command: ["sh","-c","dd if=/dev/zero of=/tmp/blob bs=1M count=200 && sleep 3600"]
    resources:
      requests:
        cpu: "50m"
        memory: "64Mi"
        ephemeral-storage: "50Mi"   # low limit on purpose
      limits:
        memory: "128Mi"
        ephemeral-storage: "80Mi"   # we'll write ~200Mi → exceed
    volumeMounts:
    - name: scratch
      mountPath: /tmp
  volumes:
  - name: scratch
    emptyDir: {}                    # uses node's ephemeral storage

Deploy & Observe:
kubectl apply -f evict-ephemeral.yaml
kubectl get pod eph-evict-demo -w
kubectl describe pod eph-evict-demo | sed -n '/Status:/,/Events/ p'
# Expect: Status: Failed  Reason: Evicted
# Message mentions ephemeral-storage usage exceeding limit
kubectl get events --sort-by=.lastTimestamp | egrep -i 'evict|ephemeral'


Resolve: redirect data to a PVC or increase the limit:
Option A: Use a PVC for large files (preferred):
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: data-pvc
spec:
  accessModes: ["ReadWriteOnce"]
  resources:
    requests: { storage: 1Gi }
---
apiVersion: v1
kind: Pod
metadata:
  name: eph-fixed-pvc
spec:
  containers:
  - name: writer
    image: busybox:1.36
    command: ["sh","-c","dd if=/dev/zero of=/data/blob bs=1M count=200 && sleep 3600"]
    volumeMounts:
    - { name: data, mountPath: /data }
    resources:
      requests:
        cpu: "50m"
        memory: "64Mi"
        ephemeral-storage: "50Mi"
      limits:
        memory: "128Mi"
        ephemeral-storage: "200Mi"
  volumes:
  - name: data
    persistentVolumeClaim: { claimName: data-pvc }


kubectl apply -f pvc-and-pod.yaml
kubectl get pod eph-fixed-pvc -w    # should stay Running; no Evicted

Option B: Increase ephemeral-storage limit and keep temp data small:
kubectl delete pod eph-evict-demo --ignore-not-found
# edit limits to, say, 300Mi or reduce file size (count=50)
kubectl apply -f evict-ephemeral.yaml

